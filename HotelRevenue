The database contains information about a hotel, like registration date, waiting time, duration of the stay, how many people, if they spent (and how much) on the hotel and many more information. The goal is to build work the data in a way it can be later used to create a
dashboard in PowerBI by answering the following questions:
Is hotel revenue growing? // Should the hotel increase the parking lot size? // What trends can be identified in the data?
Excel Document, SQL Query and PowerBI can be found at: https://drive.google.com/drive/folders/1Vc0PBJ7OJOUO1_Hoy425gE2RbvOlx53K?usp=sharing

-- Unify the tables from the three years in a single table
With hotels as (
SELECT *
FROM dbo.['2018$']
UNION
SELECT *
FROM dbo.['2019$']
UNION
SELECT *
FROM dbo.['2020$']
)
-- Joining Market Segment table to get the discount and Meal Costs table to get the value of meal prices
SELECT *
FROM hotels AS h
LEFT JOIN market_segment$ AS ms
	ON h.market_segment = ms.market_segment
LEFT JOIN meal_cost$ AS mc
	ON h.meal = mc.meal

-- Total Revenue per hotel, year and month
With hotels as (
SELECT *
FROM dbo.['2018$']
UNION
SELECT *
FROM dbo.['2019$']
UNION
SELECT *
FROM dbo.['2020$']
)
SELECT hotel, arrival_date_year, arrival_date_month, ROUND(SUM((stays_in_week_nights+stays_in_weekend_nights)*adr),2) AS Revenue
FROM hotels
GROUP BY hotel, arrival_date_year, arrival_date_month

-- Parking Spots Used
With hotels as (
SELECT *
FROM dbo.['2018$']
UNION
SELECT *
FROM dbo.['2019$']
UNION
SELECT *
FROM dbo.['2020$']
)
SELECT hotel, arrival_date_year, arrival_date_month, arrival_date_day_of_month, SUM(required_car_parking_spaces) AS Parking_Spots_Used
FROM hotels
GROUP BY hotel, arrival_date_year, arrival_date_month, arrival_date_day_of_month


-- Average stay per customer type in each hotel
WITH hotels AS
(
SELECT *
FROM dbo.['2018$']
UNION
SELECT *
FROM dbo.['2019$']
UNION
SELECT *
FROM dbo.['2020$']
)
SELECT h.hotel, h.customer_type, ROUND(AVG(h.stays_in_weekend_nights),0) AS wknd_nights, ROUND(AVG(stays_in_week_nights),0) AS week_nights
FROM hotels AS h
GROUP BY h.hotel, h.customer_type

-- Most loyal customer type
WITH hotels AS
(
SELECT *
FROM dbo.['2018$']
UNION
SELECT *
FROM dbo.['2019$']
UNION
SELECT *
FROM dbo.['2020$']
)
SELECT h.arrival_date_year, h.hotel, h.customer_type, SUM(is_repeated_guest) AS repeated_guests
FROM hotels AS h
GROUP BY h.arrival_date_year, h.hotel, h.customer_type
